"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[446],{68446:function(e,a,l){l.r(a),l.d(a,{default:function(){return $}});var t=l(56768),s=l(24232),n=l(45130);const i={class:"main-content"},o={class:"input-area"},r={class:"input-container"},d={key:0,class:"file-upload-container"},c={class:"file-info"},u={class:"file-name-display"},v={class:"input-actions"},p={class:"action-buttons"},g=["disabled"],h={class:"template-section"},m={class:"section-header"},k={class:"filter-group"},C=["value"],f=["value"],P={class:"template-grid"},L={key:0,class:"loading-tip"},b={key:1,class:"empty-tip"},F=["onClick"],y=["src","alt"],E={class:"pagination"},T=["disabled"],w=["disabled"],K=["onClick"],R=["disabled"],X=["disabled"],I={key:0,class:"result"},M=["href"],U={key:1,class:"error"};function _(e,a,l,_,S,A){return(0,t.uX)(),(0,t.CE)("div",{id:"app",class:(0,s.C4)(["ppt-generator",{"light-mode":S.isLightMode}])},[a[22]||(a[22]=(0,t.Fv)('<div class="title-section" data-v-3a9ad008><h2 class="gradient-title" data-v-3a9ad008> 一键生成<span class="ppt-text" data-v-3a9ad008>PPT</span><span class="star-icon" data-v-3a9ad008>✨</span></h2><p class="subtitle" data-v-3a9ad008>支持导入文档、利用个性化模板创作PPT</p></div>',1)),(0,t.Lk)("div",i,[(0,t.Lk)("div",o,[(0,t.Lk)("div",r,[_.selectedFile?((0,t.uX)(),(0,t.CE)("div",d,[(0,t.Lk)("div",c,[a[15]||(a[15]=(0,t.Lk)("i",{class:"file-icon"},"📄",-1)),(0,t.Lk)("span",u,(0,s.v_)(_.selectedFile.name),1),(0,t.Lk)("button",{class:"clear-file-btn",onClick:a[0]||(a[0]=(...e)=>_.clearFile&&_.clearFile(...e))},"×")])])):(0,t.Q3)("",!0),_.selectedFile?(0,t.Q3)("",!0):(0,t.bo)(((0,t.uX)(),(0,t.CE)("textarea",{key:1,"onUpdate:modelValue":a[1]||(a[1]=e=>_.description=e),placeholder:"试试输入一点点的小小的需求即可生成PPT"},null,512)),[[n.Jo,_.description]]),(0,t.Lk)("div",v,[(0,t.Lk)("div",p,[(0,t.Lk)("input",{type:"file",ref:"fileInput",onChange:a[2]||(a[2]=(...e)=>_.handleFileUpload&&_.handleFileUpload(...e)),accept:".pdf,.doc,.docx,.txt,.md",hidden:""},null,544),(0,t.Lk)("button",{onClick:a[3]||(a[3]=(...e)=>_.triggerFileUpload&&_.triggerFileUpload(...e)),class:"action-btn upload-btn"},[a[16]||(a[16]=(0,t.Lk)("i",{class:"action-icon"},"📄",-1)),(0,t.eW)((0,s.v_)(_.selectedFile?"重新上传":"上传文档"),1)])]),(0,t.Lk)("button",{class:"create-btn",disabled:_.loading||!_.selectedFile&&!_.description||!_.selectedTemplate,onClick:a[4]||(a[4]=(...e)=>_.generatePPT&&_.generatePPT(...e))},(0,s.v_)(_.loading?"生成中...":"立即创作"),9,g)])])])]),(0,t.Lk)("div",h,[(0,t.Lk)("div",m,[a[19]||(a[19]=(0,t.Lk)("h3",{class:"section-title"},"选择模板",-1)),(0,t.Lk)("div",k,[(0,t.bo)((0,t.Lk)("select",{"onUpdate:modelValue":a[5]||(a[5]=e=>_.selectedStyle=e),onChange:a[6]||(a[6]=(...e)=>_.handleFilterChange&&_.handleFilterChange(...e))},[a[17]||(a[17]=(0,t.Lk)("option",{value:""},"所有风格",-1)),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(_.styleOptions,(e=>((0,t.uX)(),(0,t.CE)("option",{key:e,value:e},(0,s.v_)(e),9,C)))),128))],544),[[n.u1,_.selectedStyle]]),(0,t.bo)((0,t.Lk)("select",{"onUpdate:modelValue":a[7]||(a[7]=e=>_.selectedColor=e),onChange:a[8]||(a[8]=(...e)=>_.handleFilterChange&&_.handleFilterChange(...e))},[a[18]||(a[18]=(0,t.Lk)("option",{value:""},"所有颜色",-1)),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(_.colorOptions,(e=>((0,t.uX)(),(0,t.CE)("option",{key:e,value:e},(0,s.v_)(e),9,f)))),128))],544),[[n.u1,_.selectedColor]])])]),(0,t.Lk)("div",P,[_.loadingTemplates?((0,t.uX)(),(0,t.CE)("div",L,"模板加载中...")):(0,t.Q3)("",!0),_.loadingTemplates||0!==_.templates.length?(0,t.Q3)("",!0):((0,t.uX)(),(0,t.CE)("div",b,[(0,t.eW)((0,s.v_)(_.hasActiveFilters?"当前筛选条件下暂无模板，请尝试其他条件":"暂无可用模板")+" ",1),_.hasActiveFilters?((0,t.uX)(),(0,t.CE)("span",{key:0,class:"clear-filter",onClick:a[9]||(a[9]=(...e)=>_.clearFilters&&_.clearFilters(...e))}," （清空筛选条件） ")):(0,t.Q3)("",!0)])),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(_.templates,(e=>((0,t.uX)(),(0,t.CE)("div",{key:e.id,class:(0,s.C4)(["template-item",{selected:_.selectedTemplate===e.id}]),onClick:a=>_.selectTemplate(e.id)},[(0,t.Lk)("img",{src:e.cover||"/default-cover.png",alt:e.name,class:"template-cover",onError:a[10]||(a[10]=(...e)=>_.handleImageError&&_.handleImageError(...e))},null,40,y),a[20]||(a[20]=(0,t.Lk)("div",{class:"template-selected-indicator"},[(0,t.Lk)("span",{class:"checkmark"},"✓")],-1))],10,F)))),128))]),(0,t.Lk)("div",E,[(0,t.Lk)("button",{onClick:a[11]||(a[11]=e=>_.changePage(1)),disabled:1===_.currentPage||0===_.totalPages}," 首页 ",8,T),(0,t.Lk)("button",{onClick:a[12]||(a[12]=e=>_.changePage(_.currentPage-1)),disabled:1===_.currentPage||0===_.totalPages}," 上一页 ",8,w),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(_.visiblePages,(e=>((0,t.uX)(),(0,t.CE)("span",{key:e,onClick:a=>_.changePage(e),class:(0,s.C4)({active:_.currentPage===e})},(0,s.v_)(e),11,K)))),128)),(0,t.Lk)("button",{onClick:a[13]||(a[13]=e=>_.changePage(_.currentPage+1)),disabled:_.currentPage===_.totalPages||0===_.totalPages}," 下一页 ",8,R),(0,t.Lk)("button",{onClick:a[14]||(a[14]=e=>_.changePage(_.totalPages)),disabled:_.currentPage===_.totalPages||0===_.totalPages}," 尾页 ",8,X)])]),_.resultUrl?((0,t.uX)(),(0,t.CE)("div",I,[(0,t.Lk)("p",null,[a[21]||(a[21]=(0,t.eW)("生成完成！")),(0,t.Lk)("a",{href:_.resultUrl,download:""},"点击下载PPT",8,M)])])):(0,t.Q3)("",!0),_.error?((0,t.uX)(),(0,t.CE)("div",U,(0,s.v_)(_.error),1)):(0,t.Q3)("",!0)],2)}var S=l(90144),A=l(94373),Q={name:"App",setup(){A.A.defaults.baseURL="http://localhost:2200/ppt";const e=(0,S.KR)(""),a=(0,S.KR)(!1),l=(0,S.KR)(""),s=(0,S.KR)(""),n=(0,S.KR)(null),i=(0,S.KR)([]),o=(0,S.KR)(!0),r=(0,S.KR)(null),d=(0,S.KR)(null),c=(0,S.KR)(null),u=(0,S.KR)(1),v=(0,S.KR)(0),p=(0,S.KR)(8),g=(0,S.KR)(""),h=(0,S.KR)(""),m=(0,S.KR)(["简约","卡通","商务","创意","国风","清新","扁平","插画","节日"]),k=(0,S.KR)(["蓝色","绿色","红色","紫色","黑色","灰色","黄色","粉色","橙色"]),C=(0,t.EW)((()=>{if(v.value<=5)return Array.from({length:v.value},((e,a)=>a+1));const e=Math.max(1,u.value-2),a=Math.min(v.value,u.value+2);return Array.from({length:a-e+1},((a,l)=>e+l))})),f=(0,t.EW)((()=>g.value||h.value)),P=()=>{d.value.click()},L=a=>{const l=a.target.files;l&&l[0]?(c.value=l[0],e.value=""):c.value=null},b=async()=>{try{o.value=!0,i.value=[];const e=await A.A.get("/templates",{params:{currentPage:u.value,pageSize:p.value,style:g.value,color:h.value}});0===e.data.code?(i.value=e.data.data.list,v.value=Math.ceil(e.data.data.total/p.value)):s.value="模板加载失败："+e.data.error}catch(e){s.value=`模板加载失败: ${e.message}`}finally{o.value=!1}},F=e=>{e=Math.max(1,Math.min(e,v.value)),e!==u.value&&(u.value=e,b())},y=e=>{e.target.src="/default-cover.png"},E=e=>{n.value=e},T=()=>{u.value=1,b()},w=()=>{g.value="",h.value="",T()},K=()=>{c.value=null,d.value.value=""},R=async()=>{try{const e=await A.A.get(`/status/${r.value}`),t=e.data.data;if(!t)throw new Error("无效的响应格式");if("build_failed"===t.pptStatus||"build_failed"===t.aiImageStatus||"build_failed"===t.cardNoteStatus)throw new Error(t.errMsg||"PPT生成失败");"done"===t.pptStatus&&"done"===t.aiImageStatus&&"done"===t.cardNoteStatus?(l.value=t.pptUrl,a.value=!1):setTimeout(R,2e3)}catch(e){s.value=`生成失败：${e.message}`,a.value=!1,r.value=null}},X=async()=>{if(n.value)try{a.value=!0,s.value="",l.value="";const t=new FormData;if(t.append("templateId",n.value),c.value)t.append("file",c.value),t.append("fileName",c.value.name);else{if(!e.value.trim())throw new Error("请输入内容描述或选择文件");t.append("query",e.value)}const i=await A.A.post("/generate",t,{headers:{"Content-Type":"multipart/form-data"}});0===i.data?.code?(r.value=i.data.task_id,R()):(s.value=i.data?.error||"生成请求失败",a.value=!1)}catch(t){s.value=`请求失败：${t.message}`,t.response&&(s.value+=` (状态码：${t.response.status})`),a.value=!1}else s.value="请先选择模板"};return(0,t.sV)(b),{description:e,loading:a,resultUrl:l,error:s,templates:i,selectedTemplate:n,selectTemplate:E,loadingTemplates:o,visiblePages:C,currentPage:u,totalPages:v,changePage:F,handleImageError:y,selectedStyle:g,selectedColor:h,styleOptions:m,colorOptions:k,handleFilterChange:T,hasActiveFilters:f,clearFilters:w,fileInput:d,selectedFile:c,triggerFileUpload:P,handleFileUpload:L,generatePPT:X,clearFile:K}},data(){return{isLightMode:"light"===localStorage.getItem("theme-mode")}},mounted(){this.checkThemeMode(),window.addEventListener("storage",this.checkThemeMode),window.addEventListener("themeChange",this.checkThemeMode)},beforeUnmount(){window.removeEventListener("storage",this.checkThemeMode),window.removeEventListener("themeChange",this.checkThemeMode)},methods:{checkThemeMode(){this.isLightMode="light"===localStorage.getItem("theme-mode")}}},x=l(71241);const W=(0,x.A)(Q,[["render",_],["__scopeId","data-v-3a9ad008"]]);var $=W}}]);
//# sourceMappingURL=446.1d630aa9.js.map