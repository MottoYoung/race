"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[486],{77486:function(e,t,a){a.r(t),a.d(t,{default:function(){return G}});var l=a(56768),i=a(24232);const s={class:"resource-layout"},o={class:"control-panel"},n={class:"form-section"},r={class:"form-section"},d={key:0,class:"upload-content"},c={key:0,class:"upload-preview"},u=["src"],h={class:"remove-btn"},p={class:"form-section"},m={class:"options-grid"},v={class:"option-item"},g={class:"option-item"},k={class:"option-item"},f={class:"option-item"},b={class:"form-action"},_={class:"preview-panel"},w={class:"preview-header"},L={class:"preview-actions"},y={class:"preview-content"},F={key:0,class:"empty-state"},S={key:0,class:"session-info"},C={key:1,class:"video-result"},V=["src"],x={class:"video-actions"};function I(e,t,a,I,q,z){const D=(0,l.g2)("el-input"),E=(0,l.g2)("UploadFilled"),U=(0,l.g2)("el-icon"),W=(0,l.g2)("el-upload"),X=(0,l.g2)("el-button"),G=(0,l.g2)("el-option"),M=(0,l.g2)("el-select"),T=(0,l.g2)("el-switch"),P=(0,l.g2)("VideoCamera"),J=(0,l.g2)("el-tooltip"),N=(0,l.g2)("Download"),Q=(0,l.g2)("Delete");return(0,l.uX)(),(0,l.CE)("div",{class:(0,i.C4)(["resource-container",{"light-mode":q.isLightMode}])},[(0,l.Lk)("div",s,[(0,l.Lk)("div",o,[t[14]||(t[14]=(0,l.Lk)("h2",{class:"panel-title"},[(0,l.eW)(" AI "),(0,l.Lk)("span",{class:"highlight"},"视频生成")],-1)),(0,l.Lk)("div",n,[t[5]||(t[5]=(0,l.Lk)("div",{class:"section-label"},"视频描述",-1)),(0,l.bF)(D,{modelValue:q.prompt,"onUpdate:modelValue":t[0]||(t[0]=e=>q.prompt=e),type:"textarea",rows:6,placeholder:"请描述您想要生成的视频内容...",class:"prompt-input",disabled:q.isGenerating},null,8,["modelValue","disabled"])]),(0,l.Lk)("div",r,[t[8]||(t[8]=(0,l.Lk)("div",{class:"section-label"},"参考图片",-1)),(0,l.bF)(W,{class:"upload-area",drag:"",action:"","auto-upload":!1,"show-file-list":!1,"on-change":z.handleFileUpload},{default:(0,l.k6)((()=>[q.image?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",d,[(0,l.bF)(U,{class:"upload-icon"},{default:(0,l.k6)((()=>[(0,l.bF)(E)])),_:1}),t[6]||(t[6]=(0,l.Lk)("div",{class:"upload-text"},[(0,l.eW)(" 拖放文件到此处或"),(0,l.Lk)("em",null,"点击上传")],-1)),t[7]||(t[7]=(0,l.Lk)("div",{class:"upload-tip"}," 支持JPG, PNG格式，推荐分辨率1024x1024 ",-1))]))])),_:1},8,["on-change"]),q.image?((0,l.uX)(),(0,l.CE)("div",c,[(0,l.Lk)("img",{src:q.image,class:"preview-image",alt:"Preview"},null,8,u),(0,l.Lk)("div",h,[(0,l.bF)(X,{type:"danger",plain:"",icon:"Delete",circle:"",onClick:z.removeImage},null,8,["onClick"])])])):(0,l.Q3)("",!0)]),(0,l.Lk)("div",p,[t[13]||(t[13]=(0,l.Lk)("div",{class:"section-label"},"生成选项",-1)),(0,l.Lk)("div",m,[(0,l.Lk)("div",v,[t[9]||(t[9]=(0,l.Lk)("div",{class:"option-label"},"生成质量",-1)),(0,l.bF)(M,{modelValue:q.quality,"onUpdate:modelValue":t[1]||(t[1]=e=>q.quality=e),class:"option-select",placeholder:"选择质量"},{default:(0,l.k6)((()=>[(0,l.bF)(G,{label:"高质量",value:"quality"}),(0,l.bF)(G,{label:"速度优先",value:"speed"})])),_:1},8,["modelValue"])]),(0,l.Lk)("div",g,[t[10]||(t[10]=(0,l.Lk)("div",{class:"option-label"},"分辨率",-1)),(0,l.bF)(M,{modelValue:q.size,"onUpdate:modelValue":t[2]||(t[2]=e=>q.size=e),class:"option-select",placeholder:"选择分辨率"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(q.resolutions,(e=>((0,l.uX)(),(0,l.Wv)(G,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,l.Lk)("div",k,[t[11]||(t[11]=(0,l.Lk)("div",{class:"option-label"},"帧率",-1)),(0,l.bF)(M,{modelValue:q.fps,"onUpdate:modelValue":t[3]||(t[3]=e=>q.fps=e),class:"option-select",placeholder:"选择帧率"},{default:(0,l.k6)((()=>[(0,l.bF)(G,{label:"24 FPS",value:"24"}),(0,l.bF)(G,{label:"30 FPS",value:"30"}),(0,l.bF)(G,{label:"60 FPS",value:"60"})])),_:1},8,["modelValue"])]),(0,l.Lk)("div",f,[t[12]||(t[12]=(0,l.Lk)("div",{class:"option-label"},"生成音频",-1)),(0,l.bF)(T,{modelValue:q.with_audio,"onUpdate:modelValue":t[4]||(t[4]=e=>q.with_audio=e),class:"option-switch","active-text":"是","inactive-text":"否"},null,8,["modelValue"])])])]),(0,l.Lk)("div",b,[(0,l.bF)(X,{loading:q.isGenerating,onClick:z.generateVideo,class:"generate-btn"},{default:(0,l.k6)((()=>[q.isGenerating?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(U,{key:0},{default:(0,l.k6)((()=>[(0,l.bF)(P)])),_:1})),(0,l.eW)(" "+(0,i.v_)(q.isGenerating?"生成中...":"生成视频"),1)])),_:1},8,["loading","onClick"])])]),(0,l.Lk)("div",_,[(0,l.Lk)("div",w,[t[16]||(t[16]=(0,l.Lk)("h2",{class:"preview-title"},"视频预览",-1)),(0,l.Lk)("div",L,[(0,l.bF)(J,{effect:"dark",content:"清除所有数据",placement:"top"},{default:(0,l.k6)((()=>[z.hasStoredData?((0,l.uX)(),(0,l.Wv)(X,{key:0,type:"danger",plain:"",icon:"Delete",onClick:z.confirmClear},{default:(0,l.k6)((()=>t[15]||(t[15]=[(0,l.eW)("清除")]))),_:1},8,["onClick"])):(0,l.Q3)("",!0)])),_:1})])]),(0,l.Lk)("div",y,[q.result?((0,l.uX)(),(0,l.CE)("div",C,[(0,l.Lk)("video",{src:q.result.result,controls:"",class:"video-player"},null,8,V),(0,l.Lk)("div",x,[(0,l.bF)(X,{type:"primary",class:"action-btn download-btn",onClick:z.downloadVideo},{default:(0,l.k6)((()=>[(0,l.bF)(U,null,{default:(0,l.k6)((()=>[(0,l.bF)(N)])),_:1}),t[19]||(t[19]=(0,l.eW)(" 下载视频 "))])),_:1},8,["onClick"]),(0,l.bF)(X,{type:"danger",plain:"",class:"action-btn",onClick:z.clearVideo},{default:(0,l.k6)((()=>[(0,l.bF)(U,null,{default:(0,l.k6)((()=>[(0,l.bF)(Q)])),_:1}),t[20]||(t[20]=(0,l.eW)(" 清除视频 "))])),_:1},8,["onClick"])])])):((0,l.uX)(),(0,l.CE)("div",F,[(0,l.bF)(U,{class:"empty-icon"},{default:(0,l.k6)((()=>[(0,l.bF)(P)])),_:1}),t[17]||(t[17]=(0,l.Lk)("div",{class:"empty-text"},"尚未生成视频",-1)),t[18]||(t[18]=(0,l.Lk)("div",{class:"empty-tip"},' 请在左侧填写视频描述和参数，然后点击"生成视频" ',-1)),z.hasStoredData?((0,l.uX)(),(0,l.CE)("div",S," 已加载上一次的会话数据 ")):(0,l.Q3)("",!0)]))])])])],2)}var q=a(94373),z=a(57477),D=a(51219),E=a(12933),U={components:{UploadFilled:z.UploadFilled,Download:z.Download,Delete:z.Delete,VideoCamera:z.VideoCamera},data(){return{prompt:"",image:null,quality:"speed",with_audio:!1,size:"1920x1080",fps:"30",result:null,isGenerating:!1,resolutions:["720x480","1024x1024","1280x960","960x1280","1920x1080","1080x1920","2048x1080","3840x2160"],isLightMode:"light"===localStorage.getItem("theme-mode")}},computed:{hasStoredData(){return null!==localStorage.getItem("video_generator_form")||null!==localStorage.getItem("video_generator_result")}},mounted(){this.checkThemeMode(),window.addEventListener("storage",this.checkThemeMode),window.addEventListener("themeChange",this.checkThemeMode),this.loadSavedState(),this.setupStateWatchers()},beforeUnmount(){window.removeEventListener("storage",this.checkThemeMode),window.removeEventListener("themeChange",this.checkThemeMode)},methods:{handleFileUpload(e){const t=new FileReader;t.onload=e=>{this.image=e.target.result},t.readAsDataURL(e.raw)},removeImage(){this.image=null},async generateVideo(){if(!this.prompt)return void D.nk.warning("请输入视频描述");this.isGenerating=!0;const e={prompt:this.prompt,image:this.image,quality:this.quality,with_audio:this.with_audio,size:this.size,fps:parseInt(this.fps)};try{const t=await q.A.post("http://localhost:2200/video/generate-video",e);this.result=t.data,D.nk.success("视频生成成功！"),this.saveState()}catch(t){console.error("生成视频失败:",t),D.nk.error("生成视频失败，请稍后重试")}finally{this.isGenerating=!1}},downloadVideo(){if(this.result&&this.result.result){const e=document.createElement("a");e.href=this.result.result,e.download="generated_video.mp4",e.click()}},checkThemeMode(){this.isLightMode="light"===localStorage.getItem("theme-mode")},loadSavedState(){try{const e=localStorage.getItem("video_generator_form");if(e){const t=JSON.parse(e);this.prompt=t.prompt||"",this.quality=t.quality||"speed",this.with_audio=t.with_audio||!1,this.size=t.size||"1920x1080",this.fps=t.fps||"30",this.image=t.image||null}const t=localStorage.getItem("video_generator_result");t&&(this.result=JSON.parse(t))}catch(e){console.error("加载保存的状态失败:",e)}},saveState(){try{const e={prompt:this.prompt,quality:this.quality,with_audio:this.with_audio,size:this.size,fps:this.fps,image:this.image};localStorage.setItem("video_generator_form",JSON.stringify(e)),this.result?localStorage.setItem("video_generator_result",JSON.stringify(this.result)):localStorage.removeItem("video_generator_result")}catch(e){console.error("保存状态失败:",e)}},setupStateWatchers(){this.$watch((()=>({prompt:this.prompt,quality:this.quality,with_audio:this.with_audio,size:this.size,fps:this.fps,image:this.image})),(()=>{this.saveState()}),{deep:!0}),this.$watch("result",(()=>{this.saveState()}),{deep:!0})},clearState(){this.prompt="",this.image=null,this.quality="speed",this.with_audio=!1,this.size="1920x1080",this.fps="30",this.result=null,localStorage.removeItem("video_generator_form"),localStorage.removeItem("video_generator_result"),D.nk.success("已清空所有数据")},confirmClear(){E.s.confirm("确定要清除所有数据吗？此操作将清空表单内容和生成的视频。","确认清除",{confirmButtonText:"确定清除",cancelButtonText:"取消",type:"warning"}).then((()=>{this.clearState()})).catch((()=>{}))},clearVideo(){this.result=null,localStorage.removeItem("video_generator_result"),D.nk.success("已清除视频")}}},W=a(71241);const X=(0,W.A)(U,[["render",I],["__scopeId","data-v-70679172"]]);var G=X}}]);
//# sourceMappingURL=486.d48a0008.js.map